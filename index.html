async function verifyCertificate() {
    const urlParams = new URLSearchParams(window.location.search);
    const certID = urlParams.get('id');

    if (!certID) {
        document.getElementById("result").innerText = "Invalid Certificate ID";
        return;
    }

    try {
        const response = await fetch(`https://script.google.com/macros/s/AKfycbw7IimiKOaR-GBOA2Zo-aj4f9XPlnFcN8MAnjSLP1TEESOX7EEWoPLLBwh_gFoJddGg/exec?id=${certID}`);
        const data = await response.json();

        if (data.name) {
            document.getElementById("result").innerHTML = `
                <h3>✅ Certificate Verified</h3>
                <p><strong>Name:</strong> ${data.name}</p>
                <p><strong>Type:</strong> ${data.type}</p>
                <p><strong>Issued on:</strong> ${data.issueDate}</p>
            `;
        } else {
            document.getElementById("result").innerHTML = `
                <h3>❌ Certificate Not Found</h3>
                <p>Please check the Certificate ID and try again.</p>
            `;
        }
    } catch (error) {
        console.error("Error fetching certificate data:", error);
        document.getElementById("result").innerHTML = `
            <h3>⚠️ Error Fetching Data</h3>
            <p>Could not fetch certificate details. Please try again later.</p>
        `;
    }
}

window.onload = verifyCertificate;
